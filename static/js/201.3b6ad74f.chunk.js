(self.webpackChunk_kne_components_system_layout=self.webpackChunk_kne_components_system_layout||[]).push([[201],{1488:(e,t,r)=>{var n=r(50149),o=r(97132),a=r(88140),s=r(35324),c=r(96614),u=r(96761),i=r(15857),l=r(68592),p=i(function(e,t){var r={};if(null==e)return r;var i=!1;t=n(t,function(t){return t=s(t,e),i||(i=t.length>1),t}),c(e,l(e),r),i&&(r=o(r,7,u));for(var p=t.length;p--;)a(r,t[p]);return r});e.exports=p},3201:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Cache:()=>x,createWithFetch:()=>D,default:()=>_,getAjax:()=>S,getCache:()=>C,preset:()=>k,request:()=>N,useFetch:()=>A,withFetch:()=>I});var n=r(94922),o=r.n(n),a=r(1488),s=r.n(a),c=r(22616),u=r.n(c),i=r(34677),l=r.n(i),p=r(82599),d=r.n(p),f=r(33097),h=r.n(f);function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g.apply(null,arguments)}function m(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}const b=["options","urlParams"];var v={id:"params",plugin:(e,t)=>{let{options:r,url:n,method:o,params:a,data:s}=e;const c=t.componentContext.getProps(),{options:i,urlParams:p}=c,d=m(c,b),f=l()({},i,u()(d,["url","method","params","data"]),r,{url:n,method:o,params:a,data:s,urlParams:p}),h=Object.assign({},f);return"object"===typeof p&&Object.keys(p).length>0&&"string"===typeof h.url&&(h.url=h.url.replace(/{([\s\S]+?)}/g,(e,t)=>p.hasOwnProperty(t)?p[t]:e)),t.componentContext.setRequestParams(f),h}};const j=["isLocal"];class x{static now(){return(new Date).getTime()}constructor(e){const{ttl:t,maxLength:r,isLocal:n,localName:o}=Object.assign({},e);this.ttl=t||0,this.data={},this.cacheNameMapping={},this.maxLength=r||1e3,this.isLocal=!!o||n,this.localName=o,this._load()}_load(){if(this.isLocal)try{const e=window.localStorage&&window.localStorage.getItem(this.localName||x.KEY_NAME);if(!e)return;const t=JSON.parse(e);Object.keys(t).forEach(e=>{t[e].isLocal=!0}),this.data=t}catch(e){}}_save(){if(!this.isLocal)return;const e=Object.keys(this.data);Promise.all(e.map(e=>this.data[e].value)).then(e=>{const t={};Object.keys(this.data).forEach((r,n)=>{const o=this.data[r],{isLocal:a}=o,s=m(o,j);!0===a&&(t[r]=Object.assign({},s,{value:e[n]}))}),window.localStorage&&window.localStorage.setItem(this.localName||x.KEY_NAME,JSON.stringify(t))})}get(e){const t=this.data[e];let r=null;return t&&(r=t.value,t.expires&&x.now()>=t.expires&&(r=null,delete this.data[e])),this._save(),r}delByCacheName(e){this.cacheNameMapping[e]&&(this.cacheNameMapping[e].forEach(e=>{this.del(e)}),this.cacheNameMapping[e].clear())}del(e){const t=this.get(e);return delete this.data[e],this._save(),t}put(e,t,r){let{ttl:n,isLocal:o,cacheName:a}=r;void 0===n&&(n=this.ttl);let s=this.del(e);if(null!==t){const r=Object.keys(this.data);if(r.length>=this.maxLength){const e=r.sort((e,t)=>this.data[e].createTime-this.data[t].createTime)[0];delete this.data[e]}const s=x.now();this.data[e]={expires:0===n?null:s+n,value:t,createTime:s,isLocal:o},a&&!this.cacheNameMapping[a]&&(this.cacheNameMapping[a]=new Set),a&&this.cacheNameMapping[a].add(e)}return this._save(),s}clean(){this.data={},this._save()}}x.KEY_NAME="REACT_FETCH_CACHE";const y={cache:new x({ttl:6e5,maxLength:1e3,isLocal:!0}),ajax:()=>{throw new Error("\u9ed8\u8ba4\u7684axios\u914d\u7f6e\u5df2\u7ecf\u79fb\u9664\uff0c\u8bf7\u9996\u5148\u5728preset\u91cc\u9762\u914d\u7f6e")},loading:null,error:null,empty:null,pagination:{initCurrent:1,pageSize:10,transform:e=>e},transformResponse:e=>{const{data:t}=e;return e.data={code:t.code,msg:t.msg,results:t.results},e}},C=()=>y.cache,S=()=>y.ajax;var k=e=>Object.assign(y,e),w={id:"cache-record",plugin:(e,t)=>{const{cache:r,isLocal:n,ttl:o}=t.componentContext.getProps(),a=!0===r?"":r,s=a+t.componentContext.getRequestToken();r&&(t.outputStack.request||t.outputStack.loader)&&void 0!==t.outputStack["output-data"]&&y.cache.put(s,t.outputStack.request||t.outputStack.loader,{ttl:o,isLocal:n,cacheName:a})},dependencies:["cache","request","output-data"]},P={id:"output-data",plugin:(e,t)=>{const{options:r,onRequestSuccess:n,ignoreSuccessState:o,transformData:a}=t.componentContext.getProps();if(Object.keys(t.errorStack).length>0)return;const s=t.output.data;if(!0!==o&&200!==s.code){const e=new Error(s.msg);throw e.responseData=s,e}const c=(e=>"function"===typeof a?a(e,t.outputStack.params):e)((!0!==o?s.results:s)||{});return n&&n(c),c},dependencies:["request"]};const q=[{id:"start",plugin:(e,t)=>{let{type:r}=e;const{onRequestStart:n}=t.componentContext.getProps(),{setIsLoading:o,setIsComplete:a}=t.componentContext;n&&n(),"refresh"===r&&o(!0),a(!1)}},v,{id:"cache",plugin:(e,t)=>{let{force:r}=e;const{cache:n}=t.componentContext.getProps(),o=t.componentContext.getRequestToken();if(!0===r||!n)return;const a=(!0===n?"":n)+o,s=y.cache.get(a);return s?Promise.resolve(s):void 0}},{id:"loader",plugin:async(e,t)=>{const{loader:r}=t.componentContext.getProps();if("function"!==typeof r)return;if(t.outputStack.cache)return t.outputStack.cache;return{data:{code:200,results:await r(t.outputStack.params)}}},dependencies:["params"]},{id:"request",plugin:(e,t)=>{let{force:r}=e;if(t.outputStack.loader||t.errorStack.loader)return;if(t.outputStack.cache)return t.outputStack.cache;const n=t.componentContext.getRequestToken();t.componentContext.requestParams=t.outputStack.params;const{ajax:o}=t.componentContext.getProps(),a=!0!==r&&h()(t.globalContext.pendingRequest,n)||(o||y.ajax)(t.outputStack.params);return t.globalContext.pendingRequest=Object.assign({},t.globalContext.pendingRequest,{[n]:a}),a.then(e=>(delete t.globalContext.pendingRequest[n],e))},dependencies:["params"]},{id:"transform-response",plugin:(e,t)=>{const{transformResponse:r,ignoreSuccessState:n,options:o}=t.componentContext.getProps(),a=t.outputStack.request;if(a)return!0===n?a:(r||y.transformResponse)(Object.assign({},a))},dependencies:["request"]},P,w,{id:"load-more",plugin:(e,t)=>{let{type:r,callback:n}=e;if("load-more"===r&&"function"===typeof n){const{fetchData:e}=t.componentContext.getState();return n(e,t.output)}},dependencies:["output-data"]},{id:"complete",plugin:(e,t)=>{let{type:r}=e;const{setIsLoading:n,setIsComplete:o,setFetchData:a}=t.componentContext;a(t.output),"refresh"===r&&n(!1),o(!0)}},{id:"error",plugin:(e,t)=>{const{onRequestError:r,onRequestComplete:n}=t.componentContext.getProps(),{setError:o}=t.componentContext;if(Object.keys(t.errorStack).length>0){const e=Object.values(t.errorStack).map(e=>e.message).filter(e=>!!e).join("\n");r&&r(Object.values(t.errorStack)),o(e||"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef")}else o(null);n&&n(t)}}],O={},R=e=>async t=>{t=Object.assign({},t);const r=q,n={props:t,globalContext:O,componentContext:e,requestContext:{},outputStack:{},errorStack:{},runPath:[],output:null},{debug:o}=e.getProps();for(let e of r)try{if((e.dependencies||[]).find(e=>-1===n.runPath.indexOf(e)))continue;!0===o&&console.info("react-fetch:plugin-"+e.id+":start",n);const r=await e.plugin(t,n);!0===o&&console.info("react-fetch:plugin-"+e.id+":complete",r),n.outputStack[e.id]=r,n.output=void 0!==r?r:n.output,n.runPath.push(e.id)}catch(a){console.error(a),n.errorStack[e.id]=a}return n},E=e=>d()(u()(e,["url","params","method","data","urlParams","options"]),{algorithm:"md5",encoding:"base64"}),A=e=>{const t=Object.assign({auto:!0,updateType:"reload"},e),r=(0,n.useRef)(t);r.current=t;const[o,a]=(0,n.useState)(!1),[s,c]=(0,n.useState)(!1),[u,i]=(0,n.useState)(null),[l,p]=(0,n.useState)(null),[d,f]=(0,n.useState)({}),h=(0,n.useRef)({isLoading:o,isComplete:s,fetchData:u,error:l,requestParams:d});h.current={isLoading:o,isComplete:s,fetchData:u,error:l,requestParams:d};const g=E(t),m=(0,n.useRef)(g);m.current=g;const b=(0,n.useRef)();(0,n.useMemo)(()=>{b.current=R({getProps:()=>r.current,getRequestToken:()=>m.current,getState:()=>h.current,requestParams:d,setRequestParams:f,setFetchData:i,setError:p,setIsComplete:c,setIsLoading:a})},[]);const v=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return b.current(Object.assign({},e,{force:t}))},j=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return b.current(Object.assign({},e,{force:t,type:"refresh"}))},x=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return b.current(Object.assign({},e,{force:t,type:"reload"}))},y=function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return b.current(Object.assign({},e,{force:r,callback:t,type:"load-more"}))},C=(0,n.useRef)({});return C.current={send:v,refresh:j,reload:x,loadMore:y,setData:i},(0,n.useEffect)(()=>{r.current.auto&&(h.current.isComplete?C.current.send({type:r.current.updateType},!1):C.current.refresh({},!1))},[g]),{isLoading:o,isComplete:s,data:u,error:l,send:v,refresh:j,reload:x,loadMore:y,setData:i,requestParams:d}},L=["component","render","loading","isEmpty","empty","error"],_=(0,n.forwardRef)((e,t)=>{let{component:r,render:a,loading:c,isEmpty:i,empty:l,error:p}=e,d=m(e,L);const{isLoading:f,isComplete:h,data:b,requestParams:v,error:j,send:x,refresh:C,reload:S,loadMore:k,setData:w}=A(d),P=["url","params","urlParams","method","data","cache","ttl","isLocal","auto","loader","options","updateType","onRequestError","onRequestSuccess","onRequestComplete","onRequestStart","debug","ajax","transformData","transformResponse"],q=s()(d,P),O=u()(d,P);if((0,n.useImperativeHandle)(t,()=>({isLoading:f,isComplete:h,data:b,requestParams:v,error:j,send:x,refresh:C,reload:S,loadMore:k,setData:w})),f)return void 0===c?y.loading:c;if(j){const e=void 0===p?y.error:p;return"function"===typeof e?e(j):e}if(!h&&!b)return null;if("function"===typeof i?i(b,v):!b)return void 0===l?y.empty:l;if(r){const e=r;return o().createElement(e,g({},q,{fetchProps:O,isComplete:h,data:b,refresh:C,reload:S,setData:w,loadMore:k,send:x,requestParams:v}))}if(a)return a(g({},q,{fetchProps:O,isComplete:h,data:b,refresh:C,reload:S,setData:w,loadMore:k,send:x,requestParams:v}));throw new Error("\u8bf7\u4f20\u5165component\u53c2\u6570\u6216\u8005render\u53c2\u6570")}),I=e=>(0,n.forwardRef)((t,r)=>o().createElement(_,g({},t,{component:e,ref:r}))),D=e=>t=>{const r=I(t);return(0,n.forwardRef)((t,n)=>o().createElement(r,g({},l()({},e,t),{ref:n})))},M=["onRequestParamsChange","onRequestDataChange","onError","onIsCompleteChange","onIsLoadingChange"],N=e=>{const t=Object.assign({},e,{options:Object.assign({},null==e?void 0:e.options)},{type:"refresh",ignoreSuccessState:!0}),{onRequestParamsChange:r,onRequestDataChange:n,onError:o,onIsCompleteChange:a,onIsLoadingChange:s}=t,c=m(t,M);return R({getProps:()=>c,getRequestToken:()=>E(c),requestParams:{},setRequestParams:function(){return r&&r(...arguments)},setFetchData:function(){return n&&n(...arguments)},setError:function(){return o&&o(...arguments)},setIsComplete:function(){return a&&a(...arguments)},setIsLoading:function(){return s&&s(...arguments)}})({}).then(e=>{let{outputStack:t}=e;return t["transform-response"]})}},5791:(e,t,r)=>{var n=r(26924),o=r(22761);e.exports=function(e){return o(e)&&"[object Map]"==n(e)}},6806:(e,t,r)=>{var n=r(61516);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},9261:(e,t,r)=>{var n=r(78420),o=r(35324),a=r(69194),s=r(46686),c=r(70914);e.exports=function(e,t,r,u){if(!s(e))return e;for(var i=-1,l=(t=o(t,e)).length,p=l-1,d=e;null!=d&&++i<l;){var f=c(t[i]),h=r;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(i!=p){var g=d[f];void 0===(h=u?u(g,f,d):void 0)&&(h=s(g)?g:a(t[i+1])?[]:{})}n(d,f,h),d=d[f]}return e}},11295:(e,t,r)=>{var n=r(9812),o=n?n.prototype:void 0,a=o?o.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{}}},15857:(e,t,r)=>{var n=r(20819),o=r(55636),a=r(46350);e.exports=function(e){return a(o(e,void 0,n),e+"")}},18630:(e,t,r)=>{var n=r(61516),o=r(6806),a=r(18962),s=r(11295),c=r(38710);e.exports=function(e,t,r){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return o(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return c(e,r);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return a(e);case"[object Symbol]":return s(e)}}},18962:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},20449:(e,t,r)=>{var n=r(26924),o=r(22761);e.exports=function(e){return o(e)&&"[object Set]"==n(e)}},20819:(e,t,r)=>{var n=r(80755);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},21676:(e,t,r)=>{var n=r(52969),o=r(53871);e.exports=function(e,t){return t.length<2?e:n(e,o(t,0,-1))}},22616:(e,t,r)=>{var n=r(94008),o=r(15857)(function(e,t){return null==e?{}:n(e,t)});e.exports=o},27449:(e,t,r)=>{var n=r(52969),o=r(9261),a=r(35324);e.exports=function(e,t,r){for(var s=-1,c=t.length,u={};++s<c;){var i=t[s],l=n(e,i);r(l,i)&&o(u,a(i,e),l)}return u}},27894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},29075:(e,t,r)=>{var n=r(96614),o=r(56326);e.exports=function(e,t){return n(e,o(e),t)}},38268:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},45921:(e,t,r)=>{var n=r(20449),o=r(47574),a=r(56832),s=a&&a.isSet,c=s?o(s):n;e.exports=c},51104:(e,t,r)=>{var n=r(96614),o=r(28673);e.exports=function(e,t){return e&&n(t,o(t),e)}},53366:(e,t,r)=>{var n=r(27894),o=r(99057);e.exports=function(e,t){return null!=e&&o(e,t,n)}},53871:e=>{e.exports=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++n<o;)a[n]=e[n+t];return a}},55119:(e,t,r)=>{var n=r(96614),o=r(30474);e.exports=function(e,t){return e&&n(t,o(t),e)}},56326:(e,t,r)=>{var n=r(48895),o=r(85990),a=r(69621),s=r(57828),c=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,a(e)),e=o(e);return t}:s;e.exports=c},57887:(e,t,r)=>{var n=r(5791),o=r(47574),a=r(56832),s=a&&a.isMap,c=s?o(s):n;e.exports=c},68592:(e,t,r)=>{var n=r(4262),o=r(56326),a=r(30474);e.exports=function(e){return n(e,a,o)}},74065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},77116:(e,t,r)=>{var n=r(9812),o=r(22777),a=r(54052),s=n?n.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||o(e)||!!(s&&e&&e[s])}},80726:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},80755:(e,t,r)=>{var n=r(48895),o=r(77116);e.exports=function e(t,r,a,s,c){var u=-1,i=t.length;for(a||(a=o),c||(c=[]);++u<i;){var l=t[u];r>0&&a(l)?r>1?e(l,r-1,a,s,c):n(c,l):s||(c[c.length]=l)}return c}},88140:(e,t,r)=>{var n=r(35324),o=r(74065),a=r(21676),s=r(70914);e.exports=function(e,t){return t=n(t,e),null==(e=a(e,t))||delete e[s(o(t))]}},94008:(e,t,r)=>{var n=r(27449),o=r(53366);e.exports=function(e,t){return n(e,t,function(t,r){return o(e,r)})}},96761:(e,t,r)=>{var n=r(12322);e.exports=function(e){return n(e)?void 0:e}},97132:(e,t,r)=>{var n=r(5538),o=r(80726),a=r(78420),s=r(51104),c=r(55119),u=r(44353),i=r(91980),l=r(98124),p=r(29075),d=r(59395),f=r(68592),h=r(26924),g=r(38268),m=r(18630),b=r(20310),v=r(54052),j=r(44543),x=r(57887),y=r(46686),C=r(45921),S=r(28673),k=r(30474),w="[object Arguments]",P="[object Function]",q="[object Object]",O={};O[w]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[q]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[P]=O["[object WeakMap]"]=!1,e.exports=function e(t,r,R,E,A,L){var _,I=1&r,D=2&r,M=4&r;if(R&&(_=A?R(t,E,A,L):R(t)),void 0!==_)return _;if(!y(t))return t;var N=v(t);if(N){if(_=g(t),!I)return i(t,_)}else{var T=h(t),F=T==P||"[object GeneratorFunction]"==T;if(j(t))return u(t,I);if(T==q||T==w||F&&!A){if(_=D||F?{}:b(t),!I)return D?p(t,c(_,t)):l(t,s(_,t))}else{if(!O[T])return A?t:{};_=m(t,T,I)}}L||(L=new n);var U=L.get(t);if(U)return U;L.set(t,_),C(t)?t.forEach(function(n){_.add(e(n,r,R,n,t,L))}):x(t)&&t.forEach(function(n,o){_.set(o,e(n,r,R,o,t,L))});var B=N?void 0:(M?D?f:d:D?k:S)(t);return o(B||t,function(n,o){B&&(n=t[o=n]),a(_,o,e(n,r,R,o,t,L))}),_}},98124:(e,t,r)=>{var n=r(96614),o=r(69621);e.exports=function(e,t){return n(e,o(e),t)}},99057:(e,t,r)=>{var n=r(35324),o=r(22777),a=r(54052),s=r(69194),c=r(56173),u=r(70914);e.exports=function(e,t,r){for(var i=-1,l=(t=n(t,e)).length,p=!1;++i<l;){var d=u(t[i]);if(!(p=null!=e&&r(e,d)))break;e=e[d]}return p||++i!=l?p:!!(l=null==e?0:e.length)&&c(l)&&s(d,l)&&(a(e)||o(e))}}}]);
//# sourceMappingURL=201.3b6ad74f.chunk.js.map